Affected version:
1.2.0

Source code:
git clone https://github.com/nih-at/libzip.git

Commit hash:
a23ac8a766c556827255111eb35ba928641efbc8

Command:
> cd /path/to/compile/source
> ./src/ziptool $FILE cat index

Expected Output:
==400696==ERROR: AddressSanitizer failed to allocate 0xc0a96a2000 (827476025344) bytes of LargeMmapAllocator (error code: 12)
==400696==Process memory map follows:
	0x00007fff7000-0x00008fff7000	
	0x00008fff7000-0x02008fff7000	
	0x02008fff7000-0x10007fff8000	
	0x555555400000-0x55555545b000	/home/skd/benchmark-setup/libzip/CVE-2017-14107/source/src/ziptool
	0x55555565b000-0x55555565c000	/home/skd/benchmark-setup/libzip/CVE-2017-14107/source/src/ziptool
	0x55555565c000-0x555555661000	/home/skd/benchmark-setup/libzip/CVE-2017-14107/source/src/ziptool
	0x600000000000-0x602000000000	
	0x602000000000-0x602000010000	
	...
==400696==End of process memory map.
==400696==AddressSanitizer CHECK failed: ../../../../src/libsanitizer/sanitizer_common/sanitizer_common.cc:118 "((0 && "unable to mmap")) != (0)" (0x0, 0x0)
    #0 0x7ffff6f01bf2  (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xe9bf2)
    #1 0x7ffff6f20575 in __sanitizer::CheckFailed(char const*, int, char const*, unsigned long long, unsigned long long) (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x108575)
    #2 0x7ffff6f0b482  (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xf3482)
    #3 0x7ffff6f17895  (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xff895)
    #4 0x7ffff6e448f1  (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x2c8f1)
    #5 0x7ffff6ef6ef7 in realloc (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xdeef7)
    #6 0x5555554148ab in _zip_cdir_grow /home/skd/benchmark-setup/libzip/CVE-2017-14107/source/lib/zip_dirent.c:108
    #7 0x5555554147b6 in _zip_cdir_new /home/skd/benchmark-setup/libzip/CVE-2017-14107/source/lib/zip_dirent.c:82

