Affected version:
2.2.0

Source code:
git clone https://github.com/uclouvain/openjpeg.git

Commit hash:
3d7cde5fc9fbc5618d02160900d32e02ed12a00e

Command:
> cd /path/to/compile/source
> ./bin/opj_compress -n 1 -i $FILE -o null.j2c

Expected Output:
/home/skd/benchmark-setup/openjpeg/CVE-2017-14151/source/src/lib/openjp2/t1.c:2042:55: runtime error: signed integer overflow: 34086911 * 64 cannot be represented in type 'int'
=================================================================
==158055==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6020000000b6 at pc 0x7ffff67dd48a bp 0x7fffffff80d0 sp 0x7fffffff80c0
WRITE of size 1 at 0x6020000000b6 thread T0
    #0 0x7ffff67dd489 in opj_mqc_byteout /home/skd/benchmark-setup/openjpeg/CVE-2017-14151/source/src/lib/openjp2/mqc.c:198
    #1 0x7ffff67df623 in opj_mqc_flush /home/skd/benchmark-setup/openjpeg/CVE-2017-14151/source/src/lib/openjp2/mqc.c:323
    #2 0x7ffff68b1fe7 in opj_t1_encode_cblk /home/skd/benchmark-setup/openjpeg/CVE-2017-14151/source/src/lib/openjp2/t1.c:2213
    #3 0x7ffff68b0fd0 in opj_t1_encode_cblks /home/skd/benchmark-setup/openjpeg/CVE-2017-14151/source/src/lib/openjp2/t1.c:2061
    #4 0x7ffff68d83d5 in opj_tcd_t1_encode /home/skd/benchmark-setup/openjpeg/CVE-2017-14151/source/src/lib/openjp2/tcd.c:2184
    #5 0x7ffff68d05a2 in opj_tcd_encode_tile /home/skd/benchmark-setup/openjpeg/CVE-2017-14151/source/src/lib/openjp2/tcd.c:1362
    #6 0x7ffff677c534 in opj_j2k_write_sod /home/skd/benchmark-setup/openjpeg/CVE-2017-14151/source/src/lib/openjp2/j2k.c:4661
    #7 0x7ffff67c299e in opj_j2k_write_first_tile_part /home/skd/benchmark-setup/openjpeg/CVE-2017-14151/source/src/lib/openjp2/j2k.c:11507
    #8 0x7ffff67c1224 in opj_j2k_post_write_tile /home/skd/benchmark-setup/openjpeg/CVE-2017-14151/source/src/lib/openjp2/j2k.c:11265
    #9 0x7ffff67be5a2 in opj_j2k_encode /home/skd/benchmark-setup/openjpeg/CVE-2017-14151/source/src/lib/openjp2/j2k.c:11014
    #10 0x7ffff67e50d5 in opj_encode /home/skd/benchmark-setup/openjpeg/CVE-2017-14151/source/src/lib/openjp2/openjpeg.c:775
    #11 0x5555554b6076 in main /home/skd/benchmark-setup/openjpeg/CVE-2017-14151/source/src/bin/jp2/opj_compress.c:1990
    #12 0x7ffff4bd5c86 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21c86)
    #13 0x5555554a8fa9 in _start (/home/skd/benchmark-setup/openjpeg/CVE-2017-14151/source/bin/opj_compress+0xa8fa9)

