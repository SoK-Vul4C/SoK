Affected version:
7.0.6.5

Source code:
git clone https://github.com/ImageMagick/ImageMagick.git

Commit hash:
781c31aeb16047d7123502666dea2ecdc97c072e

Command:
> cd /path/to/compile/source
> ./utilities/magick convert $FILE null

Expected Output:
=================================================================
==420115==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6020000081d8 at pc 0x555555ba9e63 bp 0x7fffffff6990 sp 0x7fffffff6980
READ of size 8 at 0x6020000081d8 thread T0
    #0 0x555555ba9e62 in ContrastStretchImage._omp_fn.3 MagickCore/enhance.c:1248
    #1 0x7ffff445bede in GOMP_parallel (/usr/lib/x86_64-linux-gnu/libgomp.so.1+0xdede)
    #2 0x555555b9bd38 in ContrastStretchImage MagickCore/enhance.c:1213
    #3 0x555555ba6691 in NormalizeImage MagickCore/enhance.c:3607
    #4 0x555555a2bf11 in SetImageType MagickCore/attribute.c:1262
    #5 0x555555a04c5c in WriteTIFFImage coders/tiff.c:3245
    #6 0x555555aae3c0 in WriteImage MagickCore/constitute.c:1114
    #7 0x555555aaf10e in WriteImages MagickCore/constitute.c:1333
    #8 0x555555e944c4 in ConvertImageCommand MagickWand/convert.c:3280
    #9 0x555555f3ef62 in MagickCommandGenesis MagickWand/mogrify.c:183
    #10 0x55555562cda0 in MagickMain utilities/magick.c:149
    #11 0x55555562d026 in main utilities/magick.c:180
    #12 0x7ffff38a9c86 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21c86)
    #13 0x55555562c819 in _start (/home/skd/benchmark-setup/imagemagick/CVE-2017-12876/source/utilities/magick+0x22c819)

