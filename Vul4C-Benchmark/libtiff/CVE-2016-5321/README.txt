Affected version:
4.0.6

Source code:
git clone https://github.com/vadz/libtiff.git

Commit hash:
0ba5d8814a17a64bdb8d9035f4c533f3f3f4b496

Command:
> cd /path/to/compile/source
> ./tools/tiffcrop $FILE /tmp/foo

Expected Output:
tiffcrop.c:994:36: runtime error: index 8 out of bounds for type 'unsigned char *[8]'
tiffcrop.c:994:36: runtime error: load of address 0x7fffffff7f10 with insufficient space for an object of type 'unsigned char *'
0x7fffffff7f10: note: pointer points here
 60 60 00 00  60 7f ff ff ff 7f 00 00  3f 82 66 55 55 55 00 00  02 00 00 00 00 00 00 00  80 00 00 00
              ^ 
=================================================================
==400754==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fffffff7f10 at pc 0x5555555aaa77 bp 0x7fffffff7e10 sp 0x7fffffff7e00
READ of size 8 at 0x7fffffff7f10 thread T0
    #0 0x5555555aaa76 in readSeparateTilesIntoBuffer /home/skd/benchmark-setup/libtiff/CVE-2016-5321/source/tools/tiffcrop.c:994
    #1 0x5555555d502e in loadImage /home/skd/benchmark-setup/libtiff/CVE-2016-5321/source/tools/tiffcrop.c:6079
    #2 0x5555555b4b18 in main /home/skd/benchmark-setup/libtiff/CVE-2016-5321/source/tools/tiffcrop.c:2278
    #3 0x7ffff50d0c86 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21c86)
    #4 0x5555555a9ba9 in _start (/home/skd/benchmark-setup/libtiff/CVE-2016-5321/source/tools/tiffcrop+0x1a9ba9)

