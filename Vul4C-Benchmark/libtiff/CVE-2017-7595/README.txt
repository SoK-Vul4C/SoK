Affected version:
4.0.7

Source code:
git clone https://github.com/vadz/libtiff.git

Commit hash:
2c00d31b6cd5282d172754958b8b87c362f852ee

Command:
> cd /path/to/compile/source
> ./tools/tiffcp -i $FILE /tmp/foo

Expected Output:
tif_jpeg.c:1687:26: runtime error: division by zero
ASAN:DEADLYSIGNAL
=================================================================
==400779==ERROR: AddressSanitizer: FPE on unknown address 0x5555556342a0 (pc 0x5555556342a0 bp 0x7fffffffda60 sp 0x7fffffffd960 T0)
    #0 0x55555563429f in JPEGSetupEncode /home/skd/benchmark-setup/libtiff/CVE-2017-7595/source/libtiff/tif_jpeg.c:1687
    #1 0x5555555ff66e in TIFFWriteEncodedTile /home/skd/benchmark-setup/libtiff/CVE-2017-7595/source/libtiff/tif_write.c:446
    #2 0x5555555fe827 in TIFFWriteTile /home/skd/benchmark-setup/libtiff/CVE-2017-7595/source/libtiff/tif_write.c:364
    #3 0x555555574e6e in writeBufferToContigTiles /home/skd/benchmark-setup/libtiff/CVE-2017-7595/source/tools/tiffcp.c:1549
    #4 0x55555557332d in cpImage /home/skd/benchmark-setup/libtiff/CVE-2017-7595/source/tools/tiffcp.c:1235
    #5 0x5555555759be in cpContigTiles2ContigTiles /home/skd/benchmark-setup/libtiff/CVE-2017-7595/source/tools/tiffcp.c:1694
    #6 0x555555571665 in tiffcp /home/skd/benchmark-setup/libtiff/CVE-2017-7595/source/tools/tiffcp.c:814
    #7 0x55555556e3eb in main /home/skd/benchmark-setup/libtiff/CVE-2017-7595/source/tools/tiffcp.c:303
    #8 0x7ffff50d0c86 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21c86)
    #9 0x55555556ca69 in _start (/home/skd/benchmark-setup/libtiff/CVE-2017-7595/source/tools/tiffcp+0x16ca69)

