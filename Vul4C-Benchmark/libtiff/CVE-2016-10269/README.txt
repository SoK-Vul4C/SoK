Affected version:
4.0.7

Source code:
git clone https://github.com/vadz/libtiff.git

Commit hash:
b28076b056eba9d665881bab139d21b21137fd2d

Command:
> cd /path/to/compile/source
> ./tools/tiffcp -i $FILE /tmp/foo

Expected Output:
=================================================================
==400770==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000000114 at pc 0x7ffff6e91733 bp 0x7fffffffd980 sp 0x7fffffffd128
READ of size 512 at 0x602000000114 thread T0
    #0 0x7ffff6e91732  (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x79732)
    #1 0x55555560539d in _TIFFmemcpy /home/skd/benchmark-setup/libtiff/CVE-2016-10269/source/libtiff/tif_unix.c:340
    #2 0x5555555d9ac1 in TIFFWriteDirectoryTagTransferfunction /home/skd/benchmark-setup/libtiff/CVE-2016-10269/source/libtiff/tif_dirwrite.c:1842
    #3 0x5555555d1e88 in TIFFWriteDirectorySec /home/skd/benchmark-setup/libtiff/CVE-2016-10269/source/libtiff/tif_dirwrite.c:629
    #4 0x5555555cc8e6 in TIFFWriteDirectory /home/skd/benchmark-setup/libtiff/CVE-2016-10269/source/libtiff/tif_dirwrite.c:183
    #5 0x5555555ccc07 in TIFFRewriteDirectory /home/skd/benchmark-setup/libtiff/CVE-2016-10269/source/libtiff/tif_dirwrite.c:223
    #6 0x5555555e5413 in TIFFFlush /home/skd/benchmark-setup/libtiff/CVE-2016-10269/source/libtiff/tif_flush.c:83
    #7 0x55555557d1e1 in TIFFCleanup /home/skd/benchmark-setup/libtiff/CVE-2016-10269/source/libtiff/tif_close.c:53
    #8 0x55555557de58 in TIFFClose /home/skd/benchmark-setup/libtiff/CVE-2016-10269/source/libtiff/tif_close.c:128
    #9 0x55555556f9c0 in main /home/skd/benchmark-setup/libtiff/CVE-2016-10269/source/tools/tiffcp.c:306
    #10 0x7ffff50d0c86 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21c86)
    #11 0x55555556e009 in _start (/home/skd/benchmark-setup/libtiff/CVE-2016-10269/source/tools/tiffcp+0x16e009)

