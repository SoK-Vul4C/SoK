Affected version:
4.0.7

Source code:
git clone https://github.com/vadz/libtiff.git

Commit hash:
d651abc097d91fac57f33b5f9447d0a9183f58e7

Command:
> cd /path/to/compile/source
> ./tools/tiffcrop $FILE /tmp/foo

Expected Output:
=================================================================
==1006269==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000000151 at pc 0x555555431537 bp 0x7fffffff7f40 sp 0x7fffffff7f30
WRITE of size 1 at 0x602000000151 thread T0
    #0 0x555555431536 in extractContigSamples24bits /home/yuntong/vulnfix/data/libtiff/cve_2016_9532/source/tools/tiffcrop.c:2978
    #1 0x555555433484 in extractContigSamplesToBuffer /home/yuntong/vulnfix/data/libtiff/cve_2016_9532/source/tools/tiffcrop.c:3539
    #2 0x555555427503 in writeBufferToSeparateStrips /home/yuntong/vulnfix/data/libtiff/cve_2016_9532/source/tools/tiffcrop.c:1184
    #3 0x55555544da1f in writeCroppedImage /home/yuntong/vulnfix/data/libtiff/cve_2016_9532/source/tools/tiffcrop.c:7944
    #4 0x55555542ec88 in main /home/yuntong/vulnfix/data/libtiff/cve_2016_9532/source/tools/tiffcrop.c:2356
    #5 0x7ffff6225c86 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21c86)
    #6 0x555555425ae9 in _start (/home/yuntong/vulnfix/data/libtiff/cve_2016_9532/source/tools/tiffcrop+0x25ae9)


