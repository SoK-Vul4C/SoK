Affected version:
0.4

Source code:
https://github.com/miniupnp/ngiflib

Commit hash:
b588a22

Command:
> cd /path/to/compile/source
> ./SDLaffgif $FILE

Expected Output:
=================================================================
==65061==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x63000001fe00 at pc 0x7fc5ae61c2c3 bp 0x7ffc50aaa740 sp 0x7ffc50aa9ee8
WRITE of size 1 at 0x63000001fe00 thread T0
    #0 0x7fc5ae61c2c2 in __interceptor_memcpy ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:827
    #1 0x55f5c075a9f0 in memcpy /usr/include/x86_64-linux-gnu/bits/string_fortified.h:29
    #2 0x55f5c075a9f0 in WritePixels /home/gy/experiment/ngiflib/ngiflib.c:206
    #3 0x55f5c075a9f0 in DecodeGifImg /home/gy/experiment/ngiflib/ngiflib.c:548
    #4 0x55f5c075c8a0 in LoadGif /home/gy/experiment/ngiflib/ngiflib.c:784
    #5 0x55f5c0757823 in SDL_LoadAnimatedGif /home/gy/experiment/ngiflib/ngiflibSDL.c:136
    #6 0x55f5c0756080 in main /home/gy/experiment/ngiflib/SDLaffgif.c:107
    #7 0x7fc5ae346d8f  (/lib/x86_64-linux-gnu/libc.so.6+0x29d8f)
    #8 0x7fc5ae346e3f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x29e3f)
    #9 0x55f5c0755824 in _start (/home/gy/experiment/ngiflib/SDLaffgif+0x3824)

0x63000001fe00 is located 0 bytes to the right of 64000-byte region [0x630000010400,0x63000001fe00)
allocated by thread T0 here:
    #0 0x7fc5ae696887 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x55f5c075b6e3 in LoadGif /home/gy/experiment/ngiflib/ngiflib.c:607

