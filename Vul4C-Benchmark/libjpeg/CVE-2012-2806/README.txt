Affected version:
N/A

Source code:
git clone https://github.com/libjpeg-turbo/libjpeg-turbo.git

Commit hash:
4f24016bde11aa4282900ff071a6c8481027e063

Command:
> cd /path/to/compile/source
> ./djpeg $FILE

Expected Output:
jdmarker.c:327:25: runtime error: index 4 out of bounds for type 'jpeg_component_info *[4]'
=================================================================
==407930==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fffffffe258 at pc 0x5555555610fe bp 0x7fffffffdd30 sp 0x7fffffffdd20
WRITE of size 8 at 0x7fffffffe258 thread T0
    #0 0x5555555610fd in get_sos /home/skd/benchmark-setup/libjpeg/CVE-2012-2806/source/jdmarker.c:327
    #1 0x555555570509 in read_markers /home/skd/benchmark-setup/libjpeg/CVE-2012-2806/source/jdmarker.c:1016
    #2 0x55555555c350 in consume_markers /home/skd/benchmark-setup/libjpeg/CVE-2012-2806/source/jdinput.c:386
    #3 0x55555555297d in jpeg_consume_input /home/skd/benchmark-setup/libjpeg/CVE-2012-2806/source/jdapimin.c:301
    #4 0x55555555250a in jpeg_read_header /home/skd/benchmark-setup/libjpeg/CVE-2012-2806/source/jdapimin.c:249
    #5 0x555555536f0c in main /home/skd/benchmark-setup/libjpeg/CVE-2012-2806/source/djpeg.c:542
    #6 0x7ffff5d27c86 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21c86)
    #7 0x555555533649 in _start (/home/skd/benchmark-setup/libjpeg/CVE-2012-2806/source/djpeg+0x133649)

