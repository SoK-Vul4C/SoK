--- CVE-2016-7445_CWE-476_convert.c_OLD.c	2024-05-20 09:11:38.355814360 +0000
+++ CVE-2016-7445_CWE-476_convert.c_NEW.c	2024-05-20 09:12:36.354441961 +0000
@@ -1481,8 +1481,10 @@
         if( !have_wh)
         {
             s = skip_int(s, &ph->width);
+			if(s == NULL || *s == 0) return;
 
             s = skip_int(s, &ph->height);
+			if(s == NULL || *s == 0) return;
 
             have_wh = 1;
 
@@ -1498,6 +1500,7 @@
                         break;
                     }
                 }
+				else return;
             }
             continue;
         }
@@ -1505,6 +1508,7 @@
         {
             /* P2, P3, P5, P6: */
             s = skip_int(s, &ph->maxval);
+			if(s == NULL || *s == 0) return;
 
             if(ph->maxval > 65535) return;
         }
