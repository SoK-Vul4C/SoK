Affected version:
2.2.0

Source code:
git clone https://github.com/uclouvain/openjpeg.git

Commit hash:
3d7cde5fc9fbc5618d02160900d32e02ed12a00e

Command:
> cd /path/to/compile/source
> ./bin/opj_compress -n 1 -i $FILE -o null.j2k

Expected Output:
=================================================================
==158054==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fffffff86c0 at pc 0x7ffff6e7b1da bp 0x7fffffff82e0 sp 0x7fffffff7a68
WRITE of size 36 at 0x7fffffff86c0 thread T0
    #0 0x7ffff6e7b1d9  (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x631d9)
    #1 0x7ffff6e7c327 in __interceptor___isoc99_vfscanf (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x64327)
    #2 0x7ffff6e7c426 in __interceptor___isoc99_fscanf (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x64426)
    #3 0x5555554c2397 in pgxtoimage /home/skd/benchmark-setup/openjpeg/CVE-2017-14041/source/src/bin/jp2/convert.c:1170
    #4 0x5555554b52b2 in main /home/skd/benchmark-setup/openjpeg/CVE-2017-14041/source/src/bin/jp2/opj_compress.c:1828
    #5 0x7ffff4bd5c86 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21c86)
    #6 0x5555554a8fa9 in _start (/home/skd/benchmark-setup/openjpeg/CVE-2017-14041/source/bin/opj_compress+0xa8fa9)

