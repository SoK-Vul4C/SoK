Affected version:
Master at 2017-08-16 and maybe past releases

Source code:
git clone https://github.com/uclouvain/openjpeg.git

Commit hash:
9624b2fa4722edf77fbac631e7dacaae12c91672

Command:
> cd /path/to/compile/source
> ./bin/opj_compress -r 20,10,1 -jpip -EPH -SOP -cinema2K 24 -n 1 -i $FILE -o null.j2k

Expected Output:
=================================================================
==792743==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6080000000f4 at pc 0x7ffff68b596e bp 0x7fffffff8010 sp 0x7fffffff8000
WRITE of size 1 at 0x6080000000f4 thread T0
    #0 0x7ffff68b596d in opj_t2_encode_packet /home/yuntong/vulnfix/benchmark-setup/openjpeg/CVE-2017-14039/source/src/lib/openjp2/t2.c:632
    #1 0x7ffff68b30c5 in opj_t2_encode_packets /home/yuntong/vulnfix/benchmark-setup/openjpeg/CVE-2017-14039/source/src/lib/openjp2/t2.c:316
    #2 0x7ffff68d806a in opj_tcd_t2_encode /home/yuntong/vulnfix/benchmark-setup/openjpeg/CVE-2017-14039/source/src/lib/openjp2/tcd.c:2217
    #3 0x7ffff68cfee9 in opj_tcd_encode_tile /home/yuntong/vulnfix/benchmark-setup/openjpeg/CVE-2017-14039/source/src/lib/openjp2/tcd.c:1390
    #4 0x7ffff677b9bb in opj_j2k_write_sod /home/yuntong/vulnfix/benchmark-setup/openjpeg/CVE-2017-14039/source/src/lib/openjp2/j2k.c:4661
    #5 0x7ffff67c2867 in opj_j2k_write_all_tile_parts /home/yuntong/vulnfix/benchmark-setup/openjpeg/CVE-2017-14039/source/src/lib/openjp2/j2k.c:11586
    #6 0x7ffff67c0a9e in opj_j2k_post_write_tile /home/yuntong/vulnfix/benchmark-setup/openjpeg/CVE-2017-14039/source/src/lib/openjp2/j2k.c:11287
    #7 0x7ffff67bdd8f in opj_j2k_encode /home/yuntong/vulnfix/benchmark-setup/openjpeg/CVE-2017-14039/source/src/lib/openjp2/j2k.c:11028
    #8 0x7ffff67e48c2 in opj_encode /home/yuntong/vulnfix/benchmark-setup/openjpeg/CVE-2017-14039/source/src/lib/openjp2/openjpeg.c:775
    #9 0x5555554b61f6 in main /home/yuntong/vulnfix/benchmark-setup/openjpeg/CVE-2017-14039/source/src/bin/jp2/opj_compress.c:1993
    #10 0x7ffff4bd4c86 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21c86)
    #11 0x5555554a9129 in _start (/home/yuntong/vulnfix/benchmark-setup/openjpeg/CVE-2017-14039/source/bin/opj_compress+0xa9129)

