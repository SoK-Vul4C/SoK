--- PATCH 17 ---
@@ -75,7 +75,7 @@
       field[3] = (value >> 24) & 0xff;
       /* Fall through.  */
     case 3:
-      field[2] = (value >> 16) & 0xff;
+      if (!((field < (crepair_base(field) + crepair_size(field))))) { return; } field[2] = (value >> 16) & 0xff;
       /* Fall through.  */
     case 2:
       field[1] = (value >> 8) & 0xff;