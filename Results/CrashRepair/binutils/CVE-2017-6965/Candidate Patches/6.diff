--- PATCH 6 ---
@@ -81,7 +81,7 @@
       field[1] = (value >> 8) & 0xff;
       /* Fall through.  */
     case 1:
-      field[0] = value & 0xff;
+      if (!((field < (crepair_base(field) + crepair_size(field))))) { exit(0); } field[0] = value & 0xff;
       break;
 
     default: