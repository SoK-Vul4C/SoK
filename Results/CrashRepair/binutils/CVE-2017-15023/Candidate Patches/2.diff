--- PATCH 2 ---
@@ -1891,7 +1891,7 @@
       table->files = tmp;
     }
 
-  table->files[table->num_files].name = cur_file;
+  if (!((cur_file < (crepair_base(cur_file) + crepair_size(crepair_base(cur_file)))))) { return -1; } table->files[table->num_files].name = cur_file;
   table->files[table->num_files].dir = dir;
   table->files[table->num_files].time = xtime;
   table->files[table->num_files].size = size;