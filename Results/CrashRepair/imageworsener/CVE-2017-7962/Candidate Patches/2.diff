--- /data/vulnloc/imageworsener/CVE-2017-7962/src/src/imagew-gif.c 2025-01-13T03:02:15.851867
+++ /data/vulnloc/imageworsener/CVE-2017-7962/src/src/imagew-gif.c 2025-01-13T03:02:15.851867
@@ -210,7 +210,7 @@
 	// Figure out which pixel to set.
 
 	pixnum = rctx->pixels_set + offset;
-	xi = pixnum%rctx->image_width;
+	if (!((rctx->image_width != 0))) { return; } xi = pixnum%rctx->image_width;
 	yi = pixnum/rctx->image_width;
 	xs = rctx->image_left + xi;
 	// ys = rctx->image_top + yi;
