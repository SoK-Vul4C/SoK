--- /data/vulnloc/imageworsener/CVE-2017-7962/src/src/imagew-gif.c 2025-01-13T03:02:52.173708
+++ /data/vulnloc/imageworsener/CVE-2017-7962/src/src/imagew-gif.c 2025-01-13T03:02:52.173708
@@ -662,7 +662,7 @@
 		// Read size of next subblock
 		if(!iwgif_read(rctx,rctx->rbuf,1)) goto done;
 		subblocksize = (size_t)rctx->rbuf[0];
-		if(subblocksize==0) break;
+		if((!((rctx->image_width != 0))) || (subblocksize==0)) break;
 
 		// Read next subblock
 		if(!iwgif_read(rctx,rctx->rbuf,subblocksize)) goto done;
