--- /data/vulnloc/imageworsener/CVE-2017-7962/src/src/imagew-gif.c 2025-01-13T03:02:27.780904
+++ /data/vulnloc/imageworsener/CVE-2017-7962/src/src/imagew-gif.c 2025-01-13T03:02:27.780904
@@ -666,7 +666,7 @@
 
 		// Read next subblock
 		if(!iwgif_read(rctx,rctx->rbuf,subblocksize)) goto done;
-		if(!lzw_process_bytes(rctx,&d,rctx->rbuf,subblocksize)) goto done;
+		if(((rctx->image_width != 0)) && (!lzw_process_bytes(rctx,&d,rctx->rbuf,subblocksize))) goto done;
 
 		if(d.eoi_flag) break;
 
