--- PATCH 45 ---
@@ -1815,7 +1815,7 @@
 	n = JPC_FIX_FRACBITS - 11;
 	absstepsize |= (n >= 0) ? (JPC_QCX_GETMANT(stepsize) << n) :
 	  (JPC_QCX_GETMANT(stepsize) >> (-n));
-	n = numbits - JPC_QCX_GETEXPN(stepsize);
+	if (!((((0 < n) && (n < 32)) && ((9223372036854775807 >> n) >= absstepsize)))) { return 0.0; } n = numbits - JPC_QCX_GETEXPN(stepsize);
 	absstepsize = (n >= 0) ? (absstepsize << n) : (absstepsize >> (-n));
 	return absstepsize;
 }