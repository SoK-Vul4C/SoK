--- PATCH 10 ---
@@ -1816,7 +1816,7 @@
 	absstepsize |= (n >= 0) ? (JPC_QCX_GETMANT(stepsize) << n) :
 	  (JPC_QCX_GETMANT(stepsize) >> (-n));
 	n = numbits - JPC_QCX_GETEXPN(stepsize);
-	absstepsize = (n >= 0) ? (absstepsize << n) : (absstepsize >> (-n));
+	if (!((((0 < n) && (n < 32)) && ((9223372036854775807 >> n) >= absstepsize)))) { exit(1); } absstepsize = (n >= 0) ? (absstepsize << n) : (absstepsize >> (-n));
 	return absstepsize;
 }