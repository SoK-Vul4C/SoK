--- PATCH 18 ---
@@ -1535,7 +1535,7 @@
 	if (val) {
 		*val = c;
 	}
-	return 0;
+	if (!((*val != 0))) { return 0.0; } return 0;
 }
 
 int jpc_putuint8(jas_stream_t *out, uint_fast8_t val)