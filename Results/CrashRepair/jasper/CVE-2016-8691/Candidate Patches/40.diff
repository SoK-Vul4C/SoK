--- PATCH 40 ---
@@ -1533,7 +1533,7 @@
 		return -1;
 	}
 	if (val) {
-		*val = c;
+		if (!((*val != 0))) { return c; } *val = c;
 	}
 	return 0;
 }