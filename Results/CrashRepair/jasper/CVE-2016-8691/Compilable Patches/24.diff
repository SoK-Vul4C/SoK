--- PATCH 24 ---
@@ -1532,7 +1532,7 @@
 	if ((c = jas_stream_getc(in)) == EOF) {
 		return -1;
 	}
-	if (val) {
+	if ((val) && ((c != 0))) {
 		*val = c;
 	}
 	return 0;