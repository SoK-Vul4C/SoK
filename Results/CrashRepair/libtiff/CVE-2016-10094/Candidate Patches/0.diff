--- PATCH 0 ---
@@ -2895,7 +2895,7 @@
 				return(0);
 			}
 			if(TIFFGetField(input, TIFFTAG_JPEGTABLES, &count, &jpt) != 0) {
-				if (count >= 4) {
+				if ((((buffer + count) < (crepair_base(buffer) + t2p->tiff_datasize))) && (count >= 4)) {
                     /* Ignore EOI marker of JpegTables */
 					_TIFFmemcpy(buffer, jpt, count - 2);
 					bufferoffset += count - 2;