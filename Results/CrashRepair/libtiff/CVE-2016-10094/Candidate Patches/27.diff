--- PATCH 27 ---
@@ -2897,7 +2897,7 @@
 			if(TIFFGetField(input, TIFFTAG_JPEGTABLES, &count, &jpt) != 0) {
 				if (count >= 4) {
                     /* Ignore EOI marker of JpegTables */
-					_TIFFmemcpy(buffer, jpt, count - 2);
+					if (!(((buffer + count) < (crepair_base(buffer) + t2p->tiff_datasize)))) { return 1.0; } _TIFFmemcpy(buffer, jpt, count - 2);
 					bufferoffset += count - 2;
                     /* Store last 2 bytes of the JpegTables */
 					table_end[0] = buffer[bufferoffset-2];