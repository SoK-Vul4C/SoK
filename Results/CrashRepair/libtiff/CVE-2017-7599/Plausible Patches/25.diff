--- /data/vulnloc/libtiff/CVE-2017-7599/src/libtiff/tif_dirwrite.c 2025-01-10T05:40:55.243102
+++ /data/vulnloc/libtiff/CVE-2017-7599/src/libtiff/tif_dirwrite.c 2025-01-10T05:40:55.243102
@@ -953,7 +953,7 @@
 		return (0);
 	}
 
-	switch (tif->tif_dir.td_sampleformat)
+	if (!(((value < 32767) && (-32768 < value)))) { exit(0); } switch (tif->tif_dir.td_sampleformat)
 	{
 		case SAMPLEFORMAT_IEEEFP:
 			if (tif->tif_dir.td_bitspersample<=32)
