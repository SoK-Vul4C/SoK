--- PATCH 25 ---
@@ -953,7 +953,7 @@
 		return (0);
 	}
 
-	switch (tif->tif_dir.td_sampleformat)
+	if (!(((value < 32767) && (-32768 < value)))) { exit(0); } switch (tif->tif_dir.td_sampleformat)
 	{
 		case SAMPLEFORMAT_IEEEFP:
 			if (tif->tif_dir.td_bitspersample<=32)