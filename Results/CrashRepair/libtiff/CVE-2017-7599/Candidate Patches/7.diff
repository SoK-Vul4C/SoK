--- PATCH 7 ---
@@ -977,7 +977,7 @@
 			else if (tif->tif_dir.td_bitspersample<=16)
 			{
 				for (i = 0; i < count; ++i)
-					((int16*)conv)[i] = (int16)value[i];
+					if (!(((value[i] < 32767) && (-32768 < value[i])))) { return 1.0; } ((int16*)conv)[i] = (int16)value[i];
 				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
 			}
 			else