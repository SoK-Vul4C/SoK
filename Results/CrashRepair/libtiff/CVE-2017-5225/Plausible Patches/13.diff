--- /data/vulnloc/libtiff/CVE-2017-5225/src/tools/tiffcp.c 2025-01-10T05:20:40.288747
+++ /data/vulnloc/libtiff/CVE-2017-5225/src/tools/tiffcp.c 2025-01-10T05:20:40.288747
@@ -1089,7 +1089,7 @@
 			outp = (uint8*)outbuf;
 			for (n = imagewidth; n-- > 0;) {
 				*outp++ = *inp;
-				inp += spp;
+				if (!((inp < ((inbuf + s) + scanlinesizeout)))) { return -1; } inp += spp;
 			}
 			if (TIFFWriteScanline(out, outbuf, row, s) < 0) {
 				TIFFError(TIFFFileName(out),
