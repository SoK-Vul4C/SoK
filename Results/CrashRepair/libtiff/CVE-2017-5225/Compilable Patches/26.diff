--- PATCH 26 ---
@@ -1088,7 +1088,7 @@
 			inp = ((uint8*)inbuf) + s;
 			outp = (uint8*)outbuf;
 			for (n = imagewidth; n-- > 0;) {
-				*outp++ = *inp;
+				if (!((inp < ((inbuf + s) + scanlinesizeout)))) { return 0; } *outp++ = *inp;
 				inp += spp;
 			}
 			if (TIFFWriteScanline(out, outbuf, row, s) < 0) {