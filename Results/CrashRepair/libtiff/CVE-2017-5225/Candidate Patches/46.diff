--- /data/vulnloc/libtiff/CVE-2017-5225/src/tools/tiffcp.c 2025-01-10T05:20:14.484428
+++ /data/vulnloc/libtiff/CVE-2017-5225/src/tools/tiffcp.c 2025-01-10T05:20:14.484428
@@ -1088,7 +1088,7 @@
 			inp = ((uint8*)inbuf) + s;
 			outp = (uint8*)outbuf;
 			for (n = imagewidth; n-- > 0;) {
-				*outp++ = *inp;
+				if (!((inp < ((inbuf + s) + scanlinesizeout)))) { return -1; } *outp++ = *inp;
 				inp += spp;
 			}
 			if (TIFFWriteScanline(out, outbuf, row, s) < 0) {
