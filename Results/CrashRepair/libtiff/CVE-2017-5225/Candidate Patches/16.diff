--- PATCH 16 ---
@@ -1089,7 +1089,7 @@
 			outp = (uint8*)outbuf;
 			for (n = imagewidth; n-- > 0;) {
 				*outp++ = *inp;
-				inp += spp;
+				if (!((inp < ((inbuf + s) + scanlinesizeout)))) { return 0.0; } inp += spp;
 			}
 			if (TIFFWriteScanline(out, outbuf, row, s) < 0) {
 				TIFFError(TIFFFileName(out),