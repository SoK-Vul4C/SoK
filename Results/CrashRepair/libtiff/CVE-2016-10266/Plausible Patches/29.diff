--- /data/vulnloc/libtiff/CVE-2016-10266/src/libtiff/tif_read.c 2025-01-10T05:45:52.892372
+++ /data/vulnloc/libtiff/CVE-2016-10266/src/libtiff/tif_read.c 2025-01-10T05:45:52.892372
@@ -347,7 +347,7 @@
 	if (rowsperstrip>td->td_imagelength)
 		rowsperstrip=td->td_imagelength;
 	stripsperplane=((td->td_imagelength+rowsperstrip-1)/rowsperstrip);
-	stripinplane=(strip%stripsperplane);
+	if (!((stripsperplane != 0))) { exit(0); } stripinplane=(strip%stripsperplane);
 	plane=(uint16)(strip/stripsperplane);
 	rows=td->td_imagelength-stripinplane*rowsperstrip;
 	if (rows>rowsperstrip)

