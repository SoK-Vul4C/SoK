--- PATCH 16 ---
@@ -344,7 +344,7 @@
 	 * of the separations).
 	 */
 	rowsperstrip=td->td_rowsperstrip;
-	if (rowsperstrip>td->td_imagelength)
+	if ((!((td->td_imagelength != 0))) || (rowsperstrip>td->td_imagelength))
 		rowsperstrip=td->td_imagelength;
 	stripsperplane=((td->td_imagelength+rowsperstrip-1)/rowsperstrip);
 	stripinplane=(strip%stripsperplane);