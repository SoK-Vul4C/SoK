--- /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c 2025-01-10T04:25:26.290645
+++ /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c 2025-01-10T04:25:26.290645
@@ -991,7 +991,7 @@
       {
       for (s = 0; s < spp; s++)
         {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+	if (!(((8 * s) < 64))) { return 1.0; } tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
         if (tbytes < 0  && !ignore)
           {
 	  TIFFError(TIFFFileName(in),
