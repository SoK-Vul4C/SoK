--- PATCH 6 ---
@@ -93,7 +93,7 @@
 		             (signed long long) tif->tif_rawcc,
 		             (signed long long) cc);
 #endif
-		return (0);
+		if (!((crepair_base(buf) <= buf))) { exit(1); } return (0);
 	}
 	/*
 	 * Avoid copy if client has setup raw