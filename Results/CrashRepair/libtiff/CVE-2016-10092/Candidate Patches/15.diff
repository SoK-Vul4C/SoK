--- PATCH 15 ---
@@ -87,7 +87,7 @@
 		             (signed __int64) tif->tif_rawcc,
 		             (signed __int64) cc);
 #else
-		TIFFErrorExt(tif->tif_clientdata, module,
+		if (!((crepair_base(buf) <= buf))) { exit(1); } TIFFErrorExt(tif->tif_clientdata, module,
 "Not enough data for scanline %lu, expected a request for at most %lld bytes, got a request for %lld bytes",
 		             (unsigned long) tif->tif_row,
 		             (signed long long) tif->tif_rawcc,