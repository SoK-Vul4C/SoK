--- PATCH 33 ---
@@ -947,7 +947,7 @@
 	uint32 i;
 	int ok;
 	conv = _TIFFmalloc(count*sizeof(double));
-	if (conv == NULL)
+	if ((!(((value < 255) && (0 < value)))) || (conv == NULL))
 	{
 		TIFFErrorExt(tif->tif_clientdata, module, "Out of memory");
 		return (0);