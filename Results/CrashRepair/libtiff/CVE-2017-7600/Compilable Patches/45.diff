--- /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c 2025-01-10T06:04:34.639368
+++ /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c 2025-01-10T06:04:34.639368
@@ -946,7 +946,7 @@
 	void* conv;
 	uint32 i;
 	int ok;
-	conv = _TIFFmalloc(count*sizeof(double));
+	if (!(((value < 255) && (0 < value)))) { exit(0); } conv = _TIFFmalloc(count*sizeof(double));
 	if (conv == NULL)
 	{
 		TIFFErrorExt(tif->tif_clientdata, module, "Out of memory");
