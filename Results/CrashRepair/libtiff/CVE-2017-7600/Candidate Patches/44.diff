--- PATCH 44 ---
@@ -946,7 +946,7 @@
 	void* conv;
 	uint32 i;
 	int ok;
-	conv = _TIFFmalloc(count*sizeof(double));
+	if (!(((value < 255) && (0 < value)))) { exit(1); } conv = _TIFFmalloc(count*sizeof(double));
 	if (conv == NULL)
 	{
 		TIFFErrorExt(tif->tif_clientdata, module, "Out of memory");