--- /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c 2025-01-10T06:00:06.383862
+++ /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c 2025-01-10T06:00:06.383862
@@ -953,7 +953,7 @@
 		return (0);
 	}
 
-	switch (tif->tif_dir.td_sampleformat)
+	if (!(((value < 255) && (0 < value)))) { exit(0); } switch (tif->tif_dir.td_sampleformat)
 	{
 		case SAMPLEFORMAT_IEEEFP:
 			if (tif->tif_dir.td_bitspersample<=32)
